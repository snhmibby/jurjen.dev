<!DOCTYPE html>
<html><head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	


	
	
	<script src="/js/site.js"></script>

	
	
	
	
	<link rel="stylesheet" href="/css/site.min.css">


	<title>
		jurjen.dev
		 | Basic DOM traversal 
	</title>
</head>
<body><nav class="nav-main">
	<div class="nav-icon-bar">
		<a href="#" onclick='toggleMenu()'><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-list" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"/>
</svg></a>

		<a href="/"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-fill" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293l6-6zm5-.793V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/>
  <path fill-rule="evenodd" d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"/>
</svg></a>

		<a href="https://wiki.jurjen.dev"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-stickies-fill" viewBox="0 0 16 16">
  <path d="M0 1.5V13a1 1 0 0 0 1 1V1.5a.5.5 0 0 1 .5-.5H14a1 1 0 0 0-1-1H1.5A1.5 1.5 0 0 0 0 1.5z"/>
  <path d="M3.5 2A1.5 1.5 0 0 0 2 3.5v11A1.5 1.5 0 0 0 3.5 16h6.086a1.5 1.5 0 0 0 1.06-.44l4.915-4.914A1.5 1.5 0 0 0 16 9.586V3.5A1.5 1.5 0 0 0 14.5 2h-11zm6 8.5a1 1 0 0 1 1-1h4.396a.25.25 0 0 1 .177.427l-5.146 5.146a.25.25 0 0 1-.427-.177V10.5z"/>
</svg></a>

		<a href="https://github.com/snhmibby"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16">
  <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
</svg></a>
	</div>

	<hr class="nopadding"/>
	<div id="main-menu" class="nav-menu">
		<a href="/">Home</a>
		
		
			<a  href="/about/"
				>
			About
			</a>
		
			<a  href="/tutorial/"
				>
			Tutorials
			</a>
		
	</div>
</nav>

<div id="content">

	
	
	
	
	
		
	
		
			
				
			
			
				
			
		
	
		
	
	<nav class="nav-series">
		<div class="nav-prev">
			
				<a href="https://jurjen.dev/tutorial/collapsible/" rel="prev">&larr;</a>
			
		</div>
		<a class="nav-up" href="/series/beginner-javascript">Beginner Javascript</a>
		<div class="nav-next">
			
				<a href="https://jurjen.dev/tutorial/modern-js/" rel="next">&rarr;</a>
			
		</div>
	</nav>


<hr/>
<article>
	<h1>Basic DOM traversal</h1>
	<aside class="table-of-contents">
		<nav id="TableOfContents">
  <ul>
    <li><a href="#how-we-will-do-it">How we will do it</a>
      <ul>
        <li><a href="#walking-a-list">Walking a list</a></li>
      </ul>
    </li>
    <li><a href="#codepen">Codepen</a></li>
    <li><a href="#exercises">Exercises</a></li>
  </ul>
</nav>
	</aside>
	<p>Having made such a nice collapsible in the last tutorial, it would be nice if
we can apply it to make an entire article foldable. Taking a quick look at the
HTML output of our articles it is obvious that it won&rsquo;t be as easy as making
every h1, h2, h3 element collapsible &ndash; our markdown converter appears to be
making a flat file, even though it&rsquo;s input is tree structured by the header
tags. However, with some simple Javascript programming, we can still achieve
our goal.</p>
<h1 id="how-we-will-do-it">How we will do it</h1>
<p>There are 2 obvious approaches, one would be to adjust the HTML document so
that we can use our standard collapsible on every header tag. This seems like
a clean and neat way to do it. Unfortunately we don&rsquo;t control our markdown generator.
We will do this with Javascript in some next tutorial about DOM manipulation.</p>
<p>The other is to walk over the HTML tree starting at the header we want to
collapse and hide or show everything until we find the next one.  In order to
achieve this, we will use the <a href="https://devdocs.io/javascript/">Javascript</a>
<a href="https://devdocs.io/dom/">DOM</a> <a href="https://devdocs.io/dom/element">element</a> interface methods to walk over our
HTML, toggling display-ability of the nodes we find.</p>
<p>We will make the following assumptions:</p>
<ul>
<li>The only content worth folding is within <code>&lt;article&gt;</code> HTML tags</li>
<li>The next same level header will be at the same level in the DOM, meaning we will not traverse down children to find the next header.</li>
</ul>
<p>We will hardcode some levels of folding, using different classes to toggle content.
We cannot use our simple toggle-visible class, because different layers of folding would toggle the same visibility!</p>
<h2 id="walking-a-list">Walking a list</h2>
<p>If you haven&rsquo;t read the last tutorial <a href="../collapsible/">collapsibles</a>, do
so now.  This will be basically the same, except we will use the
<a href="https://devdocs.io/dom/element">elements'</a>
<a href="https://devdocs.io/dom/element/nextelementsibling">next</a> fields to find
everything until the next header that is higher or equal to the current one.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Javascript" data-lang="Javascript"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">addFold</span>(<span style="color:#a6e22e">node</span>, <span style="color:#a6e22e">foldname</span>) {
	<span style="color:#a6e22e">node</span>.<span style="color:#a6e22e">classList</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">&#34;collapsible&#34;</span>)
	<span style="color:#a6e22e">node</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#34;click&#34;</span>, (<span style="color:#a6e22e">ev</span>) =&gt; {
		<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">clicked</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ev</span>.<span style="color:#a6e22e">currentTarget</span>
		<span style="color:#a6e22e">clicked</span>.<span style="color:#a6e22e">classList</span>.<span style="color:#a6e22e">toggle</span>(<span style="color:#e6db74">&#34;collapsible-closed&#34;</span>)
		<span style="color:#a6e22e">doAfter</span>(<span style="color:#a6e22e">ev</span>.<span style="color:#a6e22e">currentTarget</span>, (<span style="color:#a6e22e">el</span>) =&gt; {
			<span style="color:#a6e22e">el</span>.<span style="color:#a6e22e">classList</span>.<span style="color:#a6e22e">toggle</span>(<span style="color:#e6db74">&#34;collapsible-hide-&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">foldname</span>)
		});
	});
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">lvl</span>(<span style="color:#a6e22e">n</span>) {
	<span style="color:#66d9ef">switch</span> (<span style="color:#a6e22e">n</span>.<span style="color:#a6e22e">tagName</span>) {
		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;H1&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>;
		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;H2&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">2</span>;
		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;H3&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">3</span>;
		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;H4&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">4</span>;
		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;H5&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">5</span>;
		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;H6&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">6</span>;
		<span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">7</span>;
	}
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">doAfter</span>(<span style="color:#a6e22e">node</span>, <span style="color:#a6e22e">fn</span>) {
	<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">cur</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">node</span>.<span style="color:#a6e22e">nextElementSibling</span>
	<span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">cur</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">lvl</span>(<span style="color:#a6e22e">node</span>) <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">lvl</span>(<span style="color:#a6e22e">cur</span>)) {
		<span style="color:#a6e22e">fn</span>(<span style="color:#a6e22e">cur</span>)
		<span style="color:#a6e22e">cur</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">cur</span>.<span style="color:#a6e22e">nextElementSibling</span>
	}
}

<span style="color:#75715e">//find all headers in an article and make them foldable
</span><span style="color:#75715e"></span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">article</span> <span style="color:#66d9ef">of</span> document.<span style="color:#a6e22e">getElementsByTagName</span>(<span style="color:#e6db74">&#34;article&#34;</span>)) {
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">h1</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">article</span>.<span style="color:#a6e22e">getElementsByTagName</span>(<span style="color:#e6db74">&#34;h1&#34;</span>)) {
		<span style="color:#a6e22e">addFold</span>(<span style="color:#a6e22e">h1</span>, <span style="color:#e6db74">&#34;h1&#34;</span>)
	}
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">h2</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">article</span>.<span style="color:#a6e22e">getElementsByTagName</span>(<span style="color:#e6db74">&#34;h2&#34;</span>)) {
		<span style="color:#a6e22e">addFold</span>(<span style="color:#a6e22e">h2</span>, <span style="color:#e6db74">&#34;h2&#34;</span>)
	}
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">h3</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">article</span>.<span style="color:#a6e22e">getElementsByTagName</span>(<span style="color:#e6db74">&#34;h3&#34;</span>)) {
		<span style="color:#a6e22e">addFold</span>(<span style="color:#a6e22e">h3</span>, <span style="color:#e6db74">&#34;h3&#34;</span>)
	}
}

</code></pre></div><p>Our CSS is the same as our collapsible CSS, except it adds some
header-level dependent classes to toggle visibility.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-SCSS" data-lang="SCSS">
<span style="color:#a6e22e">.collapsible</span> {
	<span style="color:#f92672">display</span><span style="color:#a6e22e">:</span> <span style="color:#f92672">block</span>;
	<span style="color:#f92672">cursor</span><span style="color:#a6e22e">:</span> <span style="color:#f92672">pointer</span>;
	<span style="color:#f92672">border-bottom</span><span style="color:#a6e22e">:</span> <span style="color:#f92672">2px</span> <span style="color:#f92672">solid</span> <span style="color:#f92672">darkgrey</span>;

	<span style="color:#66d9ef">&amp;</span><span style="color:#a6e22e">::before</span> {
		<span style="color:#f92672">position</span><span style="color:#a6e22e">:</span> <span style="color:#f92672">absolute</span>;
		<span style="color:#f92672">content</span><span style="color:#a6e22e">:</span> <span style="color:#e6db74">&#34;-&#34;</span>;
		<span style="color:#f92672">left</span><span style="color:#a6e22e">:</span> <span style="color:#f92672">10px</span>;
	}
	<span style="color:#66d9ef">&amp;</span><span style="color:#a6e22e">.collapsible-closed</span><span style="color:#a6e22e">::before</span> {
		<span style="color:#f92672">content</span><span style="color:#a6e22e">:</span> <span style="color:#e6db74">&#34;+&#34;</span>;
	}
}

<span style="color:#a6e22e">.collapsible-hide-h1</span><span style="color:#f92672">,</span>
<span style="color:#a6e22e">.collapsible-hide-h2</span><span style="color:#f92672">,</span>
<span style="color:#a6e22e">.collapsible-hide-h3</span> {
	<span style="color:#f92672">display</span><span style="color:#a6e22e">:</span> <span style="color:#f92672">none</span> <span style="color:#f92672">!</span><span style="color:#f92672">important</span>;
}
</code></pre></div><h1 id="codepen">Codepen</h1>







<p 
    class="codepen" 
    data-slug-hash   ="XWaMzWE"
    data-height      ="500"
    data-default-tab ="result"
    data-user        ="jurjen-depurjen"
    style="height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">
    <span><a href="https://codepen.io/jurjen-depurjen/pen/XWaMzWE">See the Pen </a></span>
</p>
<script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>



<h1 id="exercises">Exercises</h1>
<ol>
<li>We made the assumption that the next same level header will be at the same
level in the DOM tree. This seems sensible, but not everybody is.  Use the
elements' <a href="https://devdocs.io/dom/element/children">children</a> to <a href="">recurse</a>
down and stop when you find a higher or same lvl() header.</li>
<li>(for extremely poor formatted HTML, I guess). Element is a subclass of
<a href="https://devdocs.io/dom/node">Node</a>, use the
<a href="https://devdocs.io/dom/node/parentnode">parentNode</a> to go up to find the
next same level header also.</li>
<li>The UI doesn&rsquo;t clue people how far a header reaches.  Create visual
clues on the page that give the user an indication of what will be
folded and on what level a header operates.
Indentation and highlighting might help. So might CSS <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties">Custom properties</a></li>
</ol>

</article>
<hr/>

	
	
	
	
	
		
	
		
			
				
			
			
				
			
		
	
		
	
	<nav class="nav-series">
		<div class="nav-prev">
			
				<a href="https://jurjen.dev/tutorial/collapsible/" rel="prev">&larr;</a>
			
		</div>
		<a class="nav-up" href="/series/beginner-javascript">Beginner Javascript</a>
		<div class="nav-next">
			
				<a href="https://jurjen.dev/tutorial/modern-js/" rel="next">&rarr;</a>
			
		</div>
	</nav>



    </div></body>

</html>
